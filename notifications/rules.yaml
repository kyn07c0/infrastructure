---
groups:
  - name: Sausage store rules
    rules:
    - alert: InstanceDown
      expr: up{app="backend"} == 0
      for: 1m
      labels:
        severity: critical
        project: "sausage_store"
        component: "Backend"
    - alert: Error500
      expr: rate(http_requests_total{status="500"}[2m]) > 0
      labels:
        severity: critical
        project: "sausage_store"
        component: "Backend"
    - alert: Latency
      expr: histogram_quantile(0.95, sum by (le) (rate(http_server_requests_seconds_bucket{uri="/api/orders"}[5m]))) > 0.1
      labels:
        severity: warning
        project: "sausage_store"
        component: "Backend"
    - alert: PrometheusActuatorError
      expr: rate(http_server_requests_seconds_count{uri="/actuator/prometheus", status=~"4..|5.."}[2m]) > 0
      labels:
        severity: warning
        project: "sausage_store"
        component: "Backend"
